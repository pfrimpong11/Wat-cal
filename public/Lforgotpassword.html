<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link rel="stylesheet" href="./css/forgotpassword.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@700&display=swap"
    />
</head>
<body>
    <div class="desktop-2">
        <div class="navigation">
            <img class="abstract-design-icon" alt="" src="./images/top.png" />
            <div class="material-symbolsarrow-back-io" onclick="goBack()">
                <img class="vector-icon" loading="lazy" alt="" src="./images/back.svg" />
            </div>
        </div>
        <div class="content">
            <div class="hero">
                <img class="abstract-design-icon1" loading="lazy" alt="" src="./images/topl.png" />
                <div class="hero-details">
                    <div class="title">
                        <div class="watch-name">
                            <div class="watch-logo">
                                <div class="watch-logo-child"></div>
                                <img class="logo-icon" loading="lazy" alt="" src="./images/dlogo.png" />
                            </div>
                        </div>
                        <div class="watch-label">
                            <h1 class="watcal">WatCal</h1>
                        </div>
                    </div>
                </div>
                <img class="abstract-design-icon2" loading="lazy" alt="" src="./images/topr.png" />
            </div>
            <div class="content-child"></div>
            <form class="form" id="forgotPasswordForm">
                <div class="email-input">
                    <!-- div container to display error message -->
                    <div id="message"></div>
                    <b class="enter-email">Enter Email</b>
                    <div class="rectangle-parent">
                        <div class="frame-child"></div>
                        <input id="email" class="melpetersgmailcom" placeholder="melpeters@gmail.com" type="text" />
                    </div>
                </div>
                <div class="submit-button">
                    <button class="button" id="bat">
                        <div class="text">Submit</div>
                    </button>
                </div>
            </form>
        </div>
    </div>
    <script>
        function goBack() {
            window.history.back();
        }

        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById('forgotPasswordForm').addEventListener('submit', async function (event) {
                event.preventDefault();
                const email = document.getElementById('email').value;
                try {
                    const response = await fetch('/api/forgotPasswordLandlord', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ email })
                    });

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.msg || 'Failed to send reset link');
                    }
                    window.location.href = 'emailSent.html';
                } catch (error) {
                    document.getElementById('message').innerHTML = `<p style="color: red;">${error.message}</p>`;
                    console.log("Server error");
                }
            });
        });
    </script>
</body>
</html>
